```{r}
# A Data Visualization Programming (DVP) Team Course Project (TCP) required component - MCIS6333_001 SP24
# Created by Dr. Esther Ledelle Mead, Assistant Professor of Computer Science, Southern Arkansas University (SAU)
# Created for Dr. Esther Ledelle Mead, SAU MCIS 6333 DVP Spring 2024
# Created April 10, 2024
```


#========================SECTION SEPARATOR

```{r}
# Instructions Block A:
# 1. Fill in each of the required DVP TCP informational components by entering the required information after the colon ":" located at the end of each item in the "Required DVP TCP informational components" block below.
# 2. Do not remove any content from this required Rmd template.
# 3. Some abbreviations used herein: "Bb" = "Blackboard"; "DVP" = "Data Visualization Programming"; "TCP" = "Team Course Project"; "DV" = "Data Visualization"; "DVs" = "Data Visualizations"; "OR" = "Objectives & Requirements"; "Y" = "Yes"; "N" = "No"
# 4. Any lines beginning with a pound sign (#) or sections beginning with triple quotation marks (""") will be treated by the R Interpreter as comment lines and will be passed instead of executed; i.e., will not be interpreted as executable code.
```


#========================SECTION SEPARATOR

```{r}
# Required DVP TCP informational components:
# Team Number: 4
# Team Name: The Aggregators
# Full name of assigned Use Case: Messaging App
# What is the client name for this Use Case?: Easier Life
# What is the name of the product or service that your client is researching: Message App
# Does the client have a brand name in mind for the product or service? (Yes or No): MyPosts
# If "Yes", what is the brand name that the client has in mind for the product or service? (If none, enter "NA"): 
# [Hint: All above questions about your assigned Use Case can be answered using information contained in the PDF Use Case explanation file on your Bb Team File Exchange.]

# Full name of first team member: Supraja Abburi 
# Full name of second team member: Manogna Arla 
# Full name of third team member: Tarak Nadh Naidu
# Enter "None" for any unused "Full name of ... team member:" lines in above.

# First team member contributed to this DVP TCP required component? (Y or N): Y
# Second team member contributed to this DVP TCP required component? (Y or N):Y 
# Third team member contributed to this DVP TCP required component? (Y or N): Y
# Enter "None" for any unused "...contributed..." lines in above.

```


#========================SECTION SEPARATOR

```{r}
# Instructions Block B:
# 1. Notice how the DVP TCP Objectives & Requirements (ORs) are contained in ordered successive sections below.
# 2. Notice how each set of ORs (OR1, OR2, OR3, OR4, and OR5) has its own designated insertion instructions compartment below. Follow those accordingly.
# 3. Do not remove any content from this required Rmd template.
# 4. Do not alter (edit or change in any way) the existing DVP TCP Objectives & Requirements content sections. These are the sections that begin and end with triple quotation marks (""") and are showing in red font when viewing the file from within the RStudio Cloud web-based IDE (required by all teams).
```


#========================SECTION SEPARATOR

```{r}
# Instructions Block C:
# 1. Evidence of how you used Data Visualization Programming in R to meet each Requirement and to answer each Objective as outlined below is required to exist within this Rmd file upon submission.
# 2. Teams are responsible for ensuring that they have included all of the necessary R code to enable this Rmd to work without error when opening within a NEW RStudio PROJECT of the RStudio Cloud web-based IDE wherein your assigned Use Case datasets will also be used by Dr. Mead (or proxy) in their raw form for grading purposes.
# 3. Teams are not allowed to submit any processed Use Case dataset files, and, therefore all code required for the data processing necessary to generate the required output and Data Visualizations (DVs) must be included in this Rmd file. (Large point deductions apply for failure on this point; see DVP TCP Grading Rubric on Bb.)
# 4. Each team's DVP TCP Rmd file will only be graded one time (see the DVP TCP Grading Rubric on Bb).
# 5. All DVP TCP scores are final.
# 6. All teams are treated equally.

```

#========================SECTION SEPARATOR

```{r}
# Extreme Warning!
# Severe point penalties will be applied to instances where there is evidence that a team has simply copied and pasted answer content generated by ChatGPT without having subsequently edited the content to render it "human" again by ensuring that it is written from a human perspective that is:  customized toward the assigned Use Case client, refers appropriately to the client's target customers, and refers appropriately to the client's product or service being researched.
# Extreme Warning!
```


#========================SECTION SEPARATOR

"""
DVP TCP Objectives & Requirements 1 (OR1):

Objectives (O1):
What is the predominant gender of your client's target customers?
What is the predominant income level of your client's target customers?

Requirements (R1):
Use the "Gender" variable.
Use the "Income" variable. (Note: some Use Cases contain monthly income, while others contain annual income. Be sure to include the appropriate information in your answer to the objective question.)
Use the summary() function in R.


Note: All teams are required to meet these OR1 in the final submission of their DVP TCP.
"""

#========================SECTION SEPARATOR

```{r}
# Insert your DVP TCP Data Visualization Programming R code proposed for meeting Objectives & Requirements 1 (OR1) relative to your specific assigned DVP TCP Use Case in an optimal fashion after this section.
# Based on the above OR1 description, your DVP code should generate at least two (2) DVs as visual evidence to be able to meet OR1 sufficiently.
# Insert as many new code sections as needed below.
# Two blank sections have been inserted to get you started.
```


#========================SECTION SEPARATOR

```{r}
# Install packages if required
if (!require("rmarkdown")) install.packages("rmarkdown")  # Check and install rmarkdown package if not already installed
if (!require("ggplot2")) install.packages("ggplot2")  # Check and install ggplot2 package if not already installed
if (!require("dplyr")) install.packages("dplyr")  # Check and install dplyr package if not already installed
if (!require("tm")) install.packages("tm")  # Check and install tm package if not already installed
if (!require("wordcloud")) install.packages("wordcloud")  # Check and install wordcloud package if not already installed
if (!require("RColorBrewer")) install.packages("RColorBrewer")  # Check and install RColorBrewer package if not already installed
if (!require("scales")) install.packages("scales")  # Check and install scales package if not already installed
if (!require("reshape2")) install.packages("reshape2")  # Check and install reshape2 package if not already installed

```

#========================SECTION SEPARATOR

```{r}
# Load necessary libraries
library(readxl)
library(tm)
library(wordcloud)
library(RColorBrewer)
library(scales)
library(reshape2)
library(dplyr)
```

#========================SECTION SEPARATOR

```{r}
# File paths
file_paths <- c(
  'D2.xlsx',
  'D1.xlsx',
  'D3.xlsx',
  'D4-1.xlsx',
  'D5.xlsx',
  'D6.xlsx'
)

# Function to read Excel files into a list of data frames
read_excel_files <- function(file_paths) {
  lapply(file_paths, function(path) {
    read_excel(path)
  })
}

# Read Excel files into a list of data frames
excel_data <- read_excel_files(file_paths)

# Assign each data frame to a separate variable
df1 <- excel_data[[1]]
df2 <- excel_data[[2]]
df3 <- excel_data[[3]]
df4 <- excel_data[[4]]
df5 <- excel_data[[5]]
df6 <- excel_data[[6]]

```
#========================SECTION SEPARATOR

```{r}

# Merge datasets
merged_df <- NULL
for (df in list(df1, df2, df3, df4, df5, df6)) {
  if (is.null(merged_df)) {
    merged_df <- df
  } else {
    merged_df <- merge(merged_df, df, by = 'ID', all = TRUE)
  }
}

# Define a data dictionary with maximum 5-word descriptions
data_dictionary <- list(
  ID = 'ID',
  Date='Date',
  Q1 = 'Gender',
  Q2 = 'Age',
  Q3 = 'Ethnicity',
  Q4 = 'Education_Level',
  Q5 = 'Annual_Income',
  Q6 = 'Message_Exchange_Frequency',
  Q7 = 'Importance_of_Message_Exchange',
  Q8 = 'Messaging_App_Usage_Frequency',
  Q9 = 'Message_Exchange_People_Count',
  Q10 = 'Importance_of_Permanent_Storage',
  Q11 = 'Internet_Browsing_Frequency',
  Q12 = 'TV_Watching_Frequency',
  Q13 = 'Radio_Listening_Frequency',
  Q14 = 'Magazine_Reading_Frequency',
  Q15 = 'Newspaper_Reading_Frequency',
  Q16 = 'Preferred_Payment_Schedule',
  Q17 = 'Annual_Payment_Willingness',
  Q18 = 'Monthly_Payment_Willingness',
  Q19 = 'Likelihood_to_Try_for_Superior_Security',
  Q20 = 'Likelihood_to_Try_for_Superior_Privacy_Controls',
  Q21 = 'Free',
  Q22 = 'Auto-complete',
  Q23 = 'Ensures_privacy',
  Q24 = 'Protects_identity',
  Q25 = 'Backups_to_cloud',
  Q26 = 'Spam_prevention',
  Q27 = 'Ability_to_block_users',
  Q28 = 'Ability_to_create_groups',
  Q29 = 'Encryption',
  Q30 = 'Video_calls',
  Q31 = 'Free_from_bugs',
  Q32 = 'Auto-correct',
  Q33 = 'Logo_icon',
  Q34 = 'Brand',
  Q35 = 'Design',
  Q36 = 'Speed',
  Q37 = 'Normal_update_frequency',
  Q38 = 'In-app_video_play',
  Q39 = 'Ability_to_star_messages',
  Q40 = 'Option_to_remove_ads',
  Q41 = 'Ability_to_create_audio_messages',
  Q42 = 'Transcription_of_audio_messages',
  Q43 = 'Ability_to_set_reminders',
  Q44 = 'Ability_to_remain_anonymous',
  Q45 = 'Ability_to_opt_out_of_data_collection_and_sharing',
  Q46 = 'Options_for_creating_self-destructing_messages',
  Q47 = 'Usage timeframe: 5:59am_or_earlier',
  Q48 = 'Usage timeframe: 6am_to_7:59am',
  Q49 = 'Usage timeframe: 8am_to_9:59am',
  Q50 = 'Usage timeframe: 10am_to_11:59am',
  Q51 = 'Usage timeframe: 12pm_to_1:59pm',
  Q52 = 'Usage timeframe: 2pm_to_3:59pm',
  Q53 = 'Usage timeframe: 4pm_to_5:59pm',
  Q54 = 'Usage timeframe: 5pm_to_6:59pm',
  Q55 = 'Usage timeframe: 6pm_to_7:59pm',
  Q56 = 'Usage timeframe: 8pm_to_9:59pm',
  Q57 = 'Usage timeframe: 10pm_to_11:59pm',
  Q58 = 'Usage timeframe: 11pm_or_later'
)

# Rename column headers with data dictionary descriptions
names(merged_df) <- unlist(lapply(names(merged_df), function(col) data_dictionary[[col]]))

# Display the merged data with replaced column headers
print(merged_df)


```

#========================SECTION SEPARATOR

```{r}
gender_stats <- summary(merged_df$Gender)
income_stats <- summary(merged_df$Annual_Income)

# Print the summary statistics
cat("Summary Statistics for Gender:\n")
print(gender_stats)

cat("\nSummary Statistics for Annual Income:\n")
print(income_stats)


```
#========================SECTION SEPARATOR

```{r}
# Load the required library
library(dplyr)

# Map Gender values
merged_df$Gender <- factor(merged_df$Gender, levels = c(1, 2))
levels(merged_df$Gender) <- c('Male', 'Female')

# Map Annual Income values
income_mapping <- c(
  '1' = '$29,999 or less',
  '2' = '$30,000 to $49,999',
  '3' = '$50,000 to $69,999',
  '4' = '$70,000 to $89,999',
  '5' = '$90,000 to $91,999',
  '6' = '$92,000 or more'
)
merged_df$Annual_Income <- factor(merged_df$Annual_Income, levels = names(income_mapping))
merged_df$Annual_Income <- factor(income_mapping[as.character(merged_df$Annual_Income)])

# Predominant Gender
predominant_gender <- as.character(names(which.max(table(merged_df$Gender))))

# Predominant Income Level
predominant_income_level <- as.character(names(which.max(table(merged_df$Annual_Income))))

# Display the results
cat("Predominant Gender of Target Customers:", predominant_gender, "\n")
cat("Predominant Income Level of Target Customers:", predominant_income_level, "\n")

```
#========================SECTION SEPARATOR

```{r}
# Load required libraries
library(ggplot2)
library(dplyr)


# Pie chart for Gender
gender_counts <- table(merged_df$Gender)
gender_labels <- c("Male", "Female")  # Assuming 1 = Male, 2 = Female
gender_data <- data.frame(Gender = gender_labels, Count = as.vector(gender_counts))

gender_pie <- ggplot(gender_data, aes(x = "", y = Count, fill = Gender)) +
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y", start = 0) +
  labs(title = "Message App User's Gender Distribution") +
  theme_void()

# Horizontal bar graph for Annual Income
income_counts <- table(merged_df$Annual_Income)
income_labels <- c(
  "$29,999 or less",
  "$30,000 to $49,999",
  "$50,000 to $69,999",
  "$70,000 to $89,999",
  "$90,000 to $91,999",
  "$92,000 or more"
)
income_data <- data.frame(Income = income_labels, Count = as.vector(income_counts))

print(gender_pie)


```

#========================SECTION SEPARATOR

```{r fig.width=12, fig.height=8}
income_bar <- ggplot(income_data, aes(x = Count, y = Income, fill = Income)) +
  geom_bar(stat = "identity", color = "black") +
  labs(title = "Message App User's  Annual Income Distribution", x = "Frequency") +
  theme_minimal()

# Display plots
print(income_bar)
```

#========================SECTION SEPARATOR

"""
DVP TCP Objectives & Requirements 2 (OR2):

Objectives (O2):
What is the average age of your client's target customers based on the Age variable in your client's D2 (Dataset 2)?
Did the average age of your client's target customers vary over time? For example, were those target customers who responded to the survey during the summer months different in age than those customers who responded to the survey during the winter months?

Requirements (R2):
Use the "Age" variable.
Use the "Date" variable.
Use the summary() function in R.
Group data by Date and calculate the average Age by Date.


Note: All teams are required to meet these OR2 in the final submission of their DVP TCP.
"""

#========================SECTION SEPARATOR

```{r}
# Insert your DVP TCP Data Visualization Programming R code proposed for meeting Objectives & Requirements 2 (OR2) relative to your specific assigned DVP TCP Use Case in an optimal fashion after this block.
# Based on the above OR2 description, your DVP code should generate at least one (1) DV as visual evidence to be able to meet OR2 sufficiently.
# Insert as many new code sections as needed below.
# Two blank sections have been inserted to get you started.
```


```{r}
# Selecting the Age and Date columns from merged_df
age_date_data <- merged_df[, c("Age", "Date")]

# Displaying the first few rows of age_date_data
head(age_date_data)

```

#========================SECTION SEPARATOR

```{r}
# Calculate the average age of target customers in merged_df
average_age_or2 <- mean(merged_df$Age, na.rm = TRUE)
cat("Average Age of Target Customers (OR2):", round(average_age_or2, 2), "\n")

# Group by Date and calculate average age by Date
age_by_date_or2 <- merged_df %>%
  mutate(Date = as.Date(Date)) %>%
  group_by(Date) %>%
  summarize(Average_Age = mean(Age, na.rm = TRUE))

# Print average age by Date
print("Average Age by Date (OR2):")
print(age_by_date_or2)

```


#========================SECTION SEPARATOR

```{r fig.width=12, fig.height=8}
library(ggplot2)

ggplot(age_by_date_or2, aes(x = Date, y = Average_Age, color = Average_Age)) +
  geom_line() +
  scale_color_gradient(low = "blue", high = "red") +  
  labs(x = "Date", y = "Average Age", title = "Average Age of Target Customers Over Time")

```


#========================SECTION SEPARATOR

"""
DVP TCP Objectives & Requirements 3 (OR3):

Objectives (O3):
What is the predominant education level of your client's target customers (based on "education" or "classification"; e.g., "some high school" or "freshman"?
What is the predominant educational interest area of your client's target customers (based on college major)? NOTE: If your assigned use case does not have an educational interest area variable, use a variable of your team's choice from your D3 dataset for this objective.

Requirements (R3):
Use the "Classification" variable (in some datasets it has a long title such as "What is your student classification?") or the "College Level" variable or "Education" variable (or "Level of Education").
Use the "Major" variable (in some datasets it has a long title such as "What college does your major fall under?"). NOTE: If your assigned use case does not have an educational interest area variable such as "Major", use a variable that your team's chose from your D3 dataset for O3 above for this R3 requirement.
Create frequency tables in R.
Create DVs based on frequency tables in R.


Note: All teams are required to meet these OR3 in the final submission of their DVP TCP.
"""

#========================SECTION SEPARATOR
```{r}

# Insert your DVP TCP Data Visualization Programming R code proposed for meeting Objectives & Requirements 3 (OR3) relative to your specific assigned DVP TCP Use Case in an optimal fashion after this block.
# Based on the above OR3 description, your DVP code should generate at least two (2) DVs as visual evidence to be able to meet OR3 sufficiently.
# Insert as many new code sections as needed below.
# Two blank sections have been inserted to get you started.
```


#========================SECTION SEPARATOR


```{r}
# Load necessary libraries
library(dplyr)

education_levels <- c('High school diploma', 'GED', 'Some college', "Bachelor's degree", "Master's degree", 'Doctorate','PHD')
frequency_labels <- c('Never', 'Other', 'Several times a year', 'Monthly', 'Weekly', 'Daily')

education_freq <- table(merged_df$Education_Level)
message_freq <- table(merged_df$Message_Exchange_Frequency)

names(education_freq) <- education_levels

names(message_freq) <- frequency_labels

predominant_education <- names(sort(education_freq, decreasing = TRUE))[1]
predominant_message_freq <- names(sort(message_freq, decreasing = TRUE))[1]
dvs_df <- merged_df %>%
  mutate(Predominant_Education = ifelse(Education_Level == predominant_education, 1, 0),
         Predominant_Message_Frequency = ifelse(Message_Exchange_Frequency == predominant_message_freq, 1, 0))

cat("Frequency of Education Levels:\n")
print(education_freq)
cat("\nFrequency of Message Exchange Frequency:\n")
print(message_freq)

cat("\nPredominant Education Level:", predominant_education, "\n")
cat("Predominant Message Exchange Frequency:", predominant_message_freq, "\n")


```


#========================SECTION SEPARATOR


```{r, fig.height=6, fig.width=12}
# Load necessary libraries for data visualization
library(ggplot2)

education_colors <- c('blue', 'green', 'yellow', 'orange', 'red', 'purple', 'lightblue')

ggplot(as.data.frame(education_freq), aes(x = factor(Var1, levels = education_levels), y = Freq, fill = factor(Var1))) +
  geom_bar(stat = "identity", color = "black") +
  scale_fill_manual(values = education_colors) +
  labs(title = "Message App Users Education Levels",
       x = "Education Level",
       y = "Frequency") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  guides(fill = guide_legend(title = "Education Levels"))

```

#========================SECTION SEPARATOR

```{r, fig.height=10, fig.width=10}

#color palette for the pie chart slices
pie_colors <- c('skyblue', 'lightgreen', 'yellow', 'orange', 'pink', 'purple')

#percentages based on total frequency
freq_percent <- round((message_freq / sum(message_freq)) * 100, 1)
label_with_percent <- paste0(frequency_labels, " (", freq_percent, "%)")

# Create a pie chart with percentages
pie(message_freq, labels = label_with_percent, col = pie_colors,
    main = "Frequency of Message Exchange Frequency")


```

#========================SECTION SEPARATOR

"""
DVP TCP Objectives & Requirements 4 (OR4):

Objectives (O4):
What is the average usage behavior of print media types among your client's target customers? (Hint: Use your D4-1 dataset)
What is the average usage behavior of video media types among your client's target customers? (Hint: Use your D4-1 dataset)
What is the average usage behavior of audio media types among your client's target customers? (Hint: Use your D4-1 dataset)
What are the predominant attributes that your client's target customers want in the product or service that your assigned Use Case is based on? (Hint: Use your D4-2 dataset).

Requirements (R4):
Create DVs to analyze media usage behavior variables in R.
Create DVs to analyze text data in R.


Note: All teams are required to meet these OR4 in the final submission of their DVP TCP.
"""

#========================SECTION SEPARATOR

# Insert your DVP TCP Data Visualization Programming R code proposed for meeting Objectives & Requirements 4 (OR4) relative to your specific assigned DVP TCP Use Case in an optimal fashion after this block.
# Based on the above OR4 description, your DVP code should generate at least two (2) DVs as visual evidence to be able to meet OR4 sufficiently.
# Insert as many new code sections as needed below.
# Two blank sections have been inserted to get you started.

#========================SECTION SEPARATOR

```{r}
# Calculate average values
print_media_avg <- mean(merged_df$Magazine_Reading_Frequency, na.rm = TRUE)
video_media_avg <- mean(merged_df$TV_Watching_Frequency, na.rm = TRUE)
audio_media_avg <- mean(merged_df$Radio_Listening_Frequency, na.rm = TRUE)

# Print average values
cat("Average Magazine Reading Frequency:", print_media_avg, "\n")
cat("Average TV Watching Frequency:", video_media_avg, "\n")
cat("Average Radio Listening Frequency:", audio_media_avg, "\n")

```
#========================SECTION SEPARATOR

```{r}
# Load required libraries
library(ggplot2)
library(dplyr)

# Calculate average values
print_media_avg <- mean(merged_df$Magazine_Reading_Frequency, na.rm = TRUE)
video_media_avg <- mean(merged_df$TV_Watching_Frequency, na.rm = TRUE)
audio_media_avg <- mean(merged_df$Radio_Listening_Frequency, na.rm = TRUE)

# Create data frame for violin plot
avg_values <- data.frame(
  Media = rep(c("Magazine Reading", "TV Watching", "Radio Listening"), each = nrow(merged_df)),
  Average_Frequency = c(rep(print_media_avg, nrow(merged_df)),
                        rep(video_media_avg, nrow(merged_df)),
                        rep(audio_media_avg, nrow(merged_df)))
)

# Create violin plot with increased scale, customized colors, and labels
violin_plot <- ggplot(avg_values, aes(x = Media, y = Average_Frequency, fill = Media)) +
  geom_violin(width = 0.7, alpha = 0.7) +  # Increase width for a larger scale
  geom_boxplot(width = 0.1, fill = "white", color = "black", outlier.shape = NA) +  # Add boxplot for clarity
  labs(title = "Average Media Consumption Frequencies",
       x = "Media Type",
       y = "Average Frequency") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_fill_manual(values = c("Magazine Reading" = "lightblue", 
                                "TV Watching" = "lightgreen", 
                                "Radio Listening" = "lightpink")) +  # Custom fill colors
  scale_y_continuous(expand = c(0.1, 0.1))  # Expand y-axis for better visualization

# Display violin plot
print(violin_plot)

```


#========================SECTION SEPARATOR


```{r fig.height=10, fig.width=12}
# Load required libraries
library(ggplot2)
library(dplyr)

# Group the data by 'Date' and calculate the average reading, watching, and listening frequencies
media_freq_by_date <- merged_df %>%
  group_by(Date) %>%
  summarize(
    Magazine_Reading_Frequency = mean(Magazine_Reading_Frequency, na.rm = TRUE),
    TV_Watching_Frequency = mean(TV_Watching_Frequency, na.rm = TRUE),
    Radio_Listening_Frequency = mean(Radio_Listening_Frequency, na.rm = TRUE)
  )

# Create the area chart with custom colors
area_chart <- ggplot(media_freq_by_date, aes(x = Date)) +
  geom_area(aes(y = Magazine_Reading_Frequency, fill = "Magazine Reading"), alpha = 0.4) +
  geom_area(aes(y = TV_Watching_Frequency, fill = "TV Watching"), alpha = 0.4) +
  geom_area(aes(y = Radio_Listening_Frequency, fill = "Radio Listening"), alpha = 0.4) +
  scale_fill_manual(values = c("Magazine Reading" = "red", "TV Watching" = "blue", "Radio Listening" = "green")) +
  labs(title = "Average Message App Consumption Frequencies Over Time",
       x = "Date",
       y = "Average Frequency",
       fill = "Media Type") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Display area chart
print(area_chart)

```
#========================SECTION SEPARATOR


```{r}
# Load necessary libraries for data visualization
library(ggplot2)

plot_data <- data.frame(
  Variable = rep(c("Message Exchange People Count", "Message Exchange Frequency"), each = nrow(merged_df)),
  Value = c(merged_df$Message_Exchange_People_Count, merged_df$Message_Exchange_Frequency),
  Age = rep(merged_df$Age, 2)  
)

my_colors <- c("Message Exchange People Count" = "red", "Message Exchange Frequency" = "green")

# Create a box plot with custom colors
ggplot(plot_data, aes(x = Variable, y = Value, fill = Variable)) +
  geom_boxplot(fill = my_colors) +
  labs(title = "Distribution of Message Exchange People and Frequency",
       x = "", y = "Value",
       fill = "Variable") +
  scale_fill_manual(values = my_colors, guide = FALSE) +  # Use custom colors and hide legend
  theme_minimal() +
  theme(panel.background = element_rect(fill = "white"))  # Set background color to white

```

#========================SECTION SEPARATOR



```{r}

# Load the Excel file
df <- read_excel('D4-2.xlsx')

responses_subset <- df[-1, 2]  

# Combine selected responses into a single string
text <- paste(responses_subset, collapse = ' ')

# Clean the text (optional)
text <- tolower(text)
text <- removePunctuation(text)
text <- removeNumbers(text)

if (nchar(text) == 0) {
  stop("Error: No text left after cleaning.")
} else {
  # Generate the word cloud
  wordcloud(text, scale=c(3,0.5), max.words=100, random.order=FALSE,
            colors=brewer.pal(8, "Dark2"))
  
  title("What do you want in a new messaging app?")
}

```


#========================SECTION SEPARATOR

"""
DVP TCP Objectives & Requirements 5 (OR5):

Objectives (O5):
Provide actionable decision-making-value-oriented written data insights based on target customer demographics. (Hint: Demographic variables are contained in your D1 dataset.)
What are some key differences based on gender regarding at least one of the following four possible categories: interest in, likelihood of using, intended frequency of use, and amount will to pay for your client's proposed product or service?
What are some key differences based on ethnicity regarding at least one of the following four possible categories: interest in, likelihood of using, intended frequency of use, and amount will to pay for your client's proposed product or service?
What are some key differences based on target customer income level categories regarding at least one of the following four possible categories: interest in, likelihood of using, intended frequency of use, and amount will to pay for your client's proposed product or service?

Requirements (R5):
Use a variety of Data Visualization (DV) types to summarize D3, D5, and D6 variables based on D1 variables.


Note: All teams are required to meet these OR5 in the final submission of their DVP TCP.


(This OR5 is the last set of the Objectives & Requirements (ORs) for the PP TCP.)

"""

#========================SECTION SEPARATOR

# Insert your DVP TCP Data Visualization Programming R code proposed for meeting Objectives & Requirements 5 (OR5) relative to your specific assigned DVP TCP Use Case in an optimal fashion after this block.
# Based on the above OR5 description, your DVP code should generate at least three (3) DVs as visual evidence to be able to meet OR5 sufficiently.
# Insert as many new code sections as needed below.
# Two blank sections have been inserted to get you started.

#========================SECTION SEPARATOR

```{r  fig.height=8, fig.width=14}

# Load necessary libraries for data manipulation and visualization
library(ggplot2)
library(scales)  

# Create a bubble chart with formatted legends outside the chart
ggplot(merged_df, aes(x = Message_Exchange_Frequency, y = Message_Exchange_People_Count, size = Messaging_App_Usage_Frequency, color = Messaging_App_Usage_Frequency, alpha = 0.5)) +
  geom_point(shape = 21, fill = "white", stroke = 1) +  # Use filled circles with white borders
  scale_size_continuous(range = c(5, 25)) +  # Adjust the range of bubble sizes
  scale_color_viridis_c() +  # Use viridis color palette for bubble colors with continuous scale
  labs(title = "Message Exchange Frequency and People Count and App Usage Frequency",
       x = "Message Exchange Frequency",
       y = "Message Exchange People Count",
       size = "Messaging App Usage Frequency",
       color = "Messaging App Usage Frequency") +
  theme_minimal() +  # Use a minimal theme
  theme(
    legend.position = "right",  # Move legends to the right side of the chart
    legend.title = element_text(size = 12, face = "bold"),  # Set legend title font size and style
    legend.text = element_text(size = 10),  # Set legend text font size
    legend.key.size = unit(1, "cm"),  # Adjust the size of legend symbols
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),  # Center align the plot title
    axis.title = element_text(size = 12),  # Set axis titles font size
    legend.box.background = element_rect(color = "black", fill = "white"),  # Add a border around the legend box
    panel.grid.major = element_blank(),  # Remove major grid lines
    panel.grid.minor = element_blank(),  # Remove minor grid lines
    panel.background = element_rect(fill = "white"),  # Set panel background color
    plot.background = element_rect(fill = "white"),  # Set plot background color
    axis.line = element_line(color = "black")  # Set axis line color
  )

```

#========================SECTION SEPARATOR

```{r fig.height=8, fig.width=14}
# Load necessary libraries
library(ggplot2)
library(reshape2)

# Select relevant columns for the heatmap
heatmap_df <- merged_df[, c('Education_Level', 'Annual_Income', 'Message_Exchange_Frequency', 
                            'Importance_of_Message_Exchange', 'Messaging_App_Usage_Frequency', 
                            'Message_Exchange_People_Count', 'Importance_of_Permanent_Storage', 
                            'TV_Watching_Frequency')]

# Convert non-numeric columns to numeric where possible
heatmap_df$Education_Level <- as.numeric(as.character(heatmap_df$Education_Level))
heatmap_df$Importance_of_Permanent_Storage <- as.numeric(as.character(heatmap_df$Importance_of_Permanent_Storage))

# Exclude non-numeric columns that cannot be converted
numeric_columns <- sapply(heatmap_df, is.numeric)
heatmap_df_numeric <- heatmap_df[, numeric_columns]

# Check correlation matrix
corr_matrix <- cor(heatmap_df_numeric)

# Melt the correlation matrix
melted_corr <- melt(corr_matrix)

# Plot the heatmap
ggplot(melted_corr, aes(x = Var1, y = Var2, fill = value)) +
  geom_tile() +
  scale_fill_viridis_c() +  # Use viridis color palette
  geom_text(aes(label = round(value, 2)), color = "black", size = 3) +  # Display correlation values
  labs(title = "Impact of Education, Income, and Digital Engagement on User Behavior and Preferences on Message App",
       x = "Variables", y = "Variables",
       fill = "Correlation") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for better visibility

```

#========================SECTION SEPARATOR

```{r}
# Create a scatter plot
ggplot(merged_df, aes(x = Age, y = Annual_Income)) +
  geom_point(alpha = 0.5, color = "red") +
  labs(title = "Message App relationship Age vs. Annual Income",
       x = "Age",
       y = "Annual Income") +
  theme_minimal()

```



#========================SECTION SEPARATOR
```{r fig.height=8, fig.width=14}
# Select relevant columns for scatter matrix
scatter_matrix_df <- merged_df[, c("Message_Exchange_Frequency", "Importance_of_Permanent_Storage", "Ethnicity", "TV_Watching_Frequency")]

# Define colors for each variable
variable_colors <- c("blue", "green", "red", "orange")

# Plot the scatter matrix with custom colors
pairs(scatter_matrix_df, main = " Message App Usage ",
      labels = c("Message Exchange Frequency", "Importance of Permanent Storage", "Ethnicity", "TV Watching Frequency"),
      col = variable_colors)

```



#========================SECTION SEPARATOR

# EXTREME WARNING: Do not remove any content from this required Rmd template. If you suspect that you have accidentally removed original content from this Rmd file, get a fresh copy from the appropriate MCIS6333 DVP Course Blackboard Space.

#========================SECTION SEPARATOR

"""
# EXTREME WARNING: Before you submit your Rmd file component of your DVP TCP, carefully review your submission to:
# 1) Ensure that your code works from within a NEW RStudio PROJECT of the RStudio Cloud web-based IDE (https://posit.cloud/login) based on your raw and unedited assigned Use Case datasets; 
# 2) Ensure that you have provided complete answers for each of the required Objectives questions as stated above for each set of ORs.
# 3) Ensure that you have provided sufficient visual evidence for each of the required Requirements statements as stated above for each set of ORs.
# 4) Ensure that you have provided the required number of DVs as stated above in the instructions sections for each set of ORs.
"""

#========================SECTION SEPARATOR


# End of file

